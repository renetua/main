{%- include location.html -%}

{%- assign slash = back -%}

{%- capture tlocation -%}
  {%- if location and back.size > 4 and page.dir contains 'city' or page.dir contains 'town' -%}
    {% unless back.size < 4 or page.url contains 'all.html' %}
     路 {{ site.data.lang-uk.city }} {{ location }}
    {% endunless %}
  {%- elsif back.size > 3 and page.dir contains 'district' and page.dir != '/district/town/' or back.size >= 4 and page.dir contains 'district' -%}
    {% unless back.size < 3 or page.url contains 'all.html' %}
      {% unless back.size == 4 and page.url contains '/district/town/' %}
       路 {{ location }} {{ site.data.lang-uk.district }}
      {% endunless %}
    {% endunless %}
  {%- elsif page.url == '/district/town/' -%}
  {%- endif -%}
{%- endcapture -%}

{%- assign edge = page.url | split: '/' | last -%}
{%- include folder.html dir='/assets/images/locations/' slug=edge -%}

{%- capture title -%}
  {%- if page.title -%}
    {{ page.title | smartify }}{% if tlocation != '' %}{{ tlocation }}{% endif %} 路 {{ site.title | smartify }}
  {%- else -%}
    {{ site.title | smartify }}{% if tlocation != '' %}{{ tlocation }}{% endif %} 路 {{ site.name | smartify }}
  {%- endif -%}
{%- endcapture -%}

{%- include meta-name.html -%}

{%- if page.url contains 'map.html' and page.layout == 'map' -%}
  <link rel="stylesheet" href="{{ "/assets/css/map.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}">
  <script src="{{ "/assets/js/main.map.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}"></script>
{%- else -%}

  {%- if page.table == 1 or page.table == 2 -%}
    {%- if page.url contains 'map.html' -%}
    {%- elsif slash.size >= 3 and page.dir != '/region/city/' and page.dir != '/district/town/'-%}
      <link rel="preload" href="{{ "/assets/css/main.tl.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="style">
    {%- else -%}
      <link rel="preload" href="{{ "/assets/css/main.t.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="style">
    {%- endif -%}
  {%- else -%}
    {%- if page.url contains 'map.html' -%}
    {%- elsif slash.size >= 3 and page.dir != '/region/city/' and page.dir != '/district/town/'-%}
      <link rel="preload" href="{{ "/assets/css/main.l.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="style">
    {%- else -%}
      <link rel="preload" href="{{ "/assets/css/main.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="style">
    {%- endif -%}
  {%- endif -%}

  {%- if page.dir == '/' -%}
    <link rel="preload" href="{{ "/assets/js/main.h.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="script">
  {%- else -%}
    {%- if page.table == 1 -%}
      {%- if page.url contains 'map.html' -%}
      {%- elsif slash.size >= 3 and page.dir != '/region/city/' and page.dir != '/district/town/'-%}
        <link rel="preload" href="{{ "/assets/js/main.tl.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="script">
      {%- else -%}
        <link rel="preload" href="{{ "/assets/js/main.t.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="script">
      {%- endif -%}
    {%- elsif page.table == 2 -%}
      {%- if page.url contains 'map.html' -%}
      {%- elsif slash.size >= 3 and page.dir != '/region/city/' and page.dir != '/district/town/'-%}
        <link rel="preload" href="{{ "/assets/js/main.tml.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="script">
      {%- else -%}
        <link rel="preload" href="{{ "/assets/js/main.tm.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="script">
      {%- endif -%}
    {%- else -%}
      {%- if page.url contains 'map.html' -%}
      {%- elsif slash.size >= 3 and page.dir != '/region/city/' and page.dir != '/district/town/'-%}
        <link rel="preload" href="{{ "/assets/js/main.l.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="script">
      {%- else -%}
        <link rel="preload" href="{{ "/assets/js/main.js" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" as="script">
      {%- endif -%}
    {%- endif -%}
  {%- endif -%}

  {%- if page.table == 1 or page.table == 2 -%}
    {%- if page.url contains 'map.html' -%}
    {%- elsif slash.size >= 3 and page.dir != '/region/city/' and page.dir != '/district/town/'-%}
      <link href="{{ "/assets/css/main.tl.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" rel="stylesheet">
    {%- else -%}
      <link href="{{ "/assets/css/main.t.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" rel="stylesheet">
    {%- endif -%}
  {%- else -%}
    {%- if page.url contains 'map.html' -%}
    {%- elsif slash.size >= 3 and page.dir != '/region/city/' and page.dir != '/district/town/'-%}
      <link href="{{ "/assets/css/main.l.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" rel="stylesheet">
    {%- else -%}
      <link href="{{ "/assets/css/main.css" | relative_url }}?v={{ site.time | date: '%Y%m%d%H%M%S' }}" rel="stylesheet">
    {%- endif -%}
  {%- endif -%}

{%- endif -%}
